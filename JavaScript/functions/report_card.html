<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Grades | Functions - JS (Week 5)</title>
    <style>
        *{
            padding: 0;
            margin: 0;
            box-sizing: border-box;
        }

        h1{
            margin-bottom: 20px;
        }

        main{
            display: flex;
            justify-content: space-between;
        }

        .subjects h3{
            margin-bottom: 10px;
        }

        table, th, td{
            border: 1px solid gray;
            padding: 2px;
        }

        .red{
            background-color: red;
        }

        .green{
            background-color: limegreen;
        }

        .dark_green{
            background-color: darkgreen;
        }


    </style>
</head>

<body>
    <h1>Student Grades | JS</h1>
    <main>       

        <div class="subjects">
            <h3>Wiskunde</h3>
            <table>
                <thead>
                    <tr>
                        <th>Naam</th>
                        <th>Cijfer</th>
                    </tr>
                </thead>
                <tbody id="wiskunde">
                    <tr class="willem">
                        <td >Willem</td>
                        <td class="grade" contenteditable="true" role="textbox">3</td>
                    </tr>
                    <tr class="jan">
                        <td >Jan</td>
                        <td class="grade" contenteditable="true" role="textbox">7</td>
                    </tr>
                    <tr class="kim_sing">
                        <td>Kim Sing</td>
                        <td class="grade" contenteditable="true" role="textbox">10</td>
                    </tr>
                    <tr class="samantha">
                        <td>Samantha</td>
                        <td class="grade" contenteditable="true" role="textbox">4</td>
                    </tr>
                    <tr class="joyce">
                        <td>Joyce</td>
                        <td class="grade" contenteditable="true" role="textbox">6.5</td>
                    </tr>
                    <tr class="gareth">
                        <td>Gareth</td>
                        <td class="grade" contenteditable="true" role="textbox">1</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="subjects">
            <h3>Nederlands</h3>
            <table>
                <thead>
                    <tr>
                        <th>Naam</th>
                        <th>Cijfer</th>
                    </tr>
                </thead>
                <tbody id="nederlands">
                    <tr class="willem">
                        <td>Willem</td>
                        <td class="grade" contenteditable="true" role="textbox">7</td>
                    </tr>
                    <tr class="jan">
                        <td>Jan</td>
                        <td class="grade" contenteditable="true" role="textbox">7</td>
                    </tr>
                    <tr class="kim_sing">
                        <td>Kim Sing</td>
                        <td class="grade" contenteditable="true" role="textbox">4</td>
                    </tr>
                    <tr class="samantha">
                        <td>Samantha</td>
                        <td class="grade" contenteditable="true" role="textbox">8</td>
                    </tr>
                    <tr class="joyce">
                        <td>Joyce</td>
                        <td class="grade" contenteditable="true" role="textbox">8.5</td>
                    </tr>
                    <tr class="gareth">
                        <td>Gareth</td>
                        <td class="grade" contenteditable="true" role="textbox">4</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="subjects">
            <h3>Natuurkunde</h3>
            <table>
                <thead>
                    <tr>
                        <th>Naam</th>
                        <th>Cijfer</th>
                    </tr>
                </thead>
                <tbody id="natuurkunde">
                    <tr class="willem">
                        <td>Willem</td>
                        <td class="grade" contenteditable="true" role="textbox">7</td>
                    </tr>
                    <tr class="jan">
                        <td>Jan</td>
                        <td class="grade" contenteditable="true" role="textbox">5</td>
                    </tr>
                    <tr class="kim_sing">
                        <td>Kim Sing</td>
                        <td class="grade" contenteditable="true" role="textbox">8</td>
                    </tr>
                    <tr class="samantha">
                        <td>Samantha</td>
                        <td class="grade" contenteditable="true" role="textbox">6</td>
                    </tr>
                    <tr class="joyce">
                        <td>Joyce</td>
                        <td class="grade" contenteditable="true" role="textbox">9</td>
                    </tr>
                    <tr class="gareth">
                        <td>Gareth</td>
                        <td class="grade" contenteditable="true" role="textbox">5.5</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="subjects">
            <h3>Engels</h3>
            <table>
                <thead>
                    <tr>
                        <th>Naam</th>
                        <th>Cijfer</th>
                    </tr>
                </thead>
                <tbody id="engels">
                    <tr class="willem">
                        <td>Willem</td>
                        <td class="grade engels" contenteditable="true" role="textbox">6</td>
                    </tr>
                    <tr class="jan">
                        <td>Jan</td>
                        <td class="grade engels" contenteditable="true" role="textbox">6</td>
                    </tr>
                    <tr class="kim_sing">
                        <td>Kim Sing</td>
                        <td class="grade engels" contenteditable="true" role="textbox">5.5</td>
                    </tr>
                    <tr class="samantha">
                        <td>Samantha</td>
                        <td class="grade engels" contenteditable="true" role="textbox">4.3</td>
                    </tr>
                    <tr class="joyce">
                        <td>Joyce</td>
                        <td class="grade engels" contenteditable="true" role="textbox">5.5</td>
                    </tr>
                    <tr class="gareth">
                        <td>Gareth</td>
                        <td class="grade engels" contenteditable="true" role="textbox">8</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div>
            <h3>Resultaat gemiddeld</h3>
            <table>
                <thead>
                    <tr>
                        <th>Naam</th>
                        <th>Talen</th>
                        <th>Beta vakken</th>
                        <th>Volgende klas? >6.5</th>
                    </tr>
                </thead>
                <tbody id="conclusion">
                    <tr id="willem">
                        <td>Willem</td>
                        <td class="talen grade"></td>
                        <td class="beta grade"></td>
                        <td class="volgende_klas grade"></td>
                    </tr>
                    <tr id="jan">
                        <td>Jan</td>
                        <td class="talen grade"></td>
                        <td class="beta grade"></td>
                        <td class="volgende_klas grade"></td>
                    </tr>
                    <tr id="kim_sing">
                        <td>Kim Sing</td>
                        <td class="talen grade"></td>
                        <td class="beta grade"></td>
                        <td class="volgende_klas grade"></td>
                    </tr>
                    <tr id="samantha">
                        <td>Samantha</td>
                        <td class="talen grade"></td>
                        <td class="beta grade"></td>
                        <td class="volgende_klas grade"></td>
                    </tr>
                    <tr id="joyce">
                        <td>Joyce</td>
                        <td class="talen grade"></td>
                        <td class="beta grade"></td>
                        <td class="volgende_klas grade"></td>
                    </tr>
                    <tr id="gareth">
                        <td>Gareth</td>
                        <td class="talen grade"></td>
                        <td class="beta grade"></td>
                        <td class="volgende_klas grade"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>

    <script>
        /**
         * VARS
         * ------
         */
        let tbody__conslusion = document.getElementById('conclusion');
        let willem = {"name":"Willem", "number": 0, "grades":{}};
        let jan = {"name":"Jan", "number": 1, "grades":{}};
        let kimSing = {"name":"Kim_Sing", "number": 2, "grades":{}};
        let samantha = {"name":"Samantha", "number": 3, "grades":{}};
        let joyce = {"name":"Joyce", "number": 4, "grades":{}};
        let gareth = {"name":"Gareth", "number": 5, "grades":{}};
        const students = [
            willem, jan, kimSing, samantha, joyce, gareth
        ];        

        /**
         * Get & Set student grades
         * ------------------
         * - Wiskunde (wis)
         * - Nederlands (nl)
         * - Engels (en)
         * - Natuurkunde(na)
         * */

        // Wiskunde
        willem.grades.wiskunde = getGrade('wiskunde', willem.name);
        jan.grades.wiskunde = getGrade('wiskunde', jan.name);
        kimSing.grades.wiskunde = getGrade('wiskunde', kimSing.name);
        samantha.grades.wiskunde = getGrade('wiskunde', samantha.name);
        joyce.grades.wiskunde = getGrade('wiskunde', joyce.name);
        gareth.grades.wiskunde = getGrade('wiskunde', gareth.name);

        // Natuurkunde
        willem.grades.natuurkunde = getGrade('natuurkunde', willem.name);
        jan.grades.natuurkunde = getGrade('natuurkunde', jan.name);
        kimSing.grades.natuurkunde = getGrade('natuurkunde', kimSing.name);
        samantha.grades.natuurkunde = getGrade('natuurkunde', samantha.name);
        joyce.grades.natuurkunde = getGrade('natuurkunde', joyce.name);
        gareth.grades.natuurkunde = getGrade('natuurkunde', gareth.name);

        // Engels        
        willem.grades.engels = getGrade('engels', willem.name);
        jan.grades.engels = getGrade('engels', jan.name);
        kimSing.grades.engels = getGrade('engels', kimSing.name);
        samantha.grades.engels = getGrade('engels', samantha.name);
        joyce.grades.engels = getGrade('engels', joyce.name);
        gareth.grades.engels = getGrade('engels', gareth.name);

        // Nederlands
        willem.grades.nederlands = getGrade('nederlands', willem.name);
        jan.grades.nederlands = getGrade('nederlands', jan.name);
        kimSing.grades.nederlands = getGrade('nederlands', kimSing.name);
        samantha.grades.nederlands = getGrade('nederlands', samantha.name);
        joyce.grades.nederlands = getGrade('nederlands', joyce.name);
        gareth.grades.nederlands = getGrade('nederlands', gareth.name);

        // Beta
        willem.grades.beta = calcAvg(willem.grades.natuurkunde, willem.grades.wiskunde);
        jan.grades.beta = calcAvg(jan.grades.natuurkunde, jan.grades.wiskunde);
        kimSing.grades.beta = calcAvg(kimSing.grades.natuurkunde, kimSing.grades.wiskunde);
        samantha.beta = calcAvg(samantha.grades.natuurkunde, samantha.grades.wiskunde);
        joyce.grades.beta = calcAvg(joyce.grades.natuurkunde, joyce.grades.wiskunde);
        gareth.grades.beta = calcAvg(gareth.grades.natuurkunde, gareth.grades.wiskunde);

        // Talen
        willem.grades.talen = calcAvg(willem.grades.nederlands, willem.grades.engels);
        jan.grades.talen = calcAvg(jan.grades.nederlands, jan.grades.engels);
        kimSing.grades.talen = calcAvg(kimSing.grades.nederlands, kimSing.grades.engels);
        samantha.talen = calcAvg(samantha.grades.nederlands, samantha.grades.engels);
        joyce.grades.talen = calcAvg(joyce.grades.nederlands, joyce.grades.engels);
        gareth.grades.talen = calcAvg(gareth.grades.nederlands, gareth.grades.engels);

        // Advance to next grade?
        willem.advance = checkAdvance(willem.grades.beta, willem.grades.talen);
        jan.advance = checkAdvance(jan.grades.beta, jan.grades.talen);
        kimSing.advance = checkAdvance(kimSing.grades.beta, kimSing.grades.talen);
        samantha.advance = checkAdvance(samantha.grades.beta, samantha.grades.talen);
        joyce.advance = checkAdvance(joyce.grades.beta, joyce.grades.talen);
        gareth.advance = checkAdvance(gareth.grades.beta, gareth.grades.talen);
        
        students.forEach(element => {
            fillGrade2Element(tbody__conslusion, element);
        });
        
        /** 
         * AddEventlistener to all grade classes to detect change
         * 
         *
         */
        // Array.from(document.getElementsByClassName('grade')).forEach(element => {
        //     // element.addEventListener('change', updateGrade(this));
        //     console.log(element.textContent);
        // });

        /**
         * Function: getGrade
         * ---------------------
         * params: _subject: String, name: String
         * 
         * ---------------------
         * function
         * 
         * 
         * */
        function getGrade(_subject, _name) {
            let _childnr = checkChildNr(_name);
            return parseFloat(document.getElementById(_subject).children[_childnr].getElementsByClassName('grade')[0].textContent);
        }

        /**
         * fillGrade2Element
         * --------
         * Write out to element
         * */
        function fillGrade2Element(element, studentData) {

            console.log(studentData.name.toLowerCase());
            console.log(element.getElementById(studentData.name.toLowerCase()));
            //Wiskunde
            // document.getElementById('wiskunde').getElementsByClassName(studentData.name).getElementsByClassName('grade').textContent = studentData.grades.wiskunde
            // element.getElementsByClassName(studentData.name).getElementsByClassName('grade')
            //Nederlands
            studentData.grades.nederlands

            //Natuurkunde
            studentData.grades.natuurkunde

            //Engels
            studentData.grades.engels

            //Talen
            studentData.grades.talen

            //Beta
            studentData.grades.beta

            //Advance
            studentData.advance
        }

        /**
         * checkAdvance
         * ------------
         * If avg of beta and talen >6.5?yes:no
         * 
         * */
        function checkAdvance(beta, talen) {
            const _beta = Number(beta);
            const _talen = Number(talen);
            const avg = calcAvg(_beta, _talen);

            if (avg > 6.5) {
                return 'yes';
            } else {
                return 'no';
            }
        }

        /**
         * CheckChildNr
         * ------------
         * returns the number of the child from a given name
         * param: name:String
         * return: int
         * */
        function checkChildNr(name) {
            // console.log(`Name to find CHILD for is ${name.toLowerCase()}`);
            switch (name.toLowerCase()) {
                case 'willem':
                    return 0;
                    break;
                case 'jan':
                    return 1;
                    break;
                case 'kim_sing':
                    return 2;
                    break;
                case 'samantha':
                    return 3;
                    break;
                case 'joyce':
                    return 4;
                    break;
                case 'gareth':
                    return 5;
                    break;            
                default:
                    return null;
                    break;
            }            
        }

        /**
         * updateGrade
         * 
         * */
        function updateGrade(obj) {
            // getGrade(obj);
            console.log(`Grade UPGRADED: ${obj}`);
            // console.log(obj.target);
            
            
        }

        /**
         * calcAvg
         * ------
         * Calculates average out of 2 numbers
         * 
         * */
        function calcAvg(_nr1, _nr2){
            return (_nr1+_nr2)/2;
        }

        function formatCheck(data) {
            checkFormatClassAdded(data);

            if (grade >= 7.5) {
                return addClass(data, "darkGreen");
            } else 
            if (grade >= 5.5) {
                return addClass(data, "green");
            }else
            if(grade< 5.5){
                return addClass(data, "red");
            }
        }

        function addClass(obj) {
            
        }


    </script>
    
</body>
</html>